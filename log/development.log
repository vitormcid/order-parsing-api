Started POST "/orders" for ::1 at 2021-05-08 20:47:31 -0300
  
ActiveRecord::NoDatabaseError (FATAL:  role "danilo" does not exist
):
  
activerecord (5.2.6) lib/active_record/connection_adapters/postgresql_adapter.rb:696:in `rescue in connect'
activerecord (5.2.6) lib/active_record/connection_adapters/postgresql_adapter.rb:691:in `connect'
activerecord (5.2.6) lib/active_record/connection_adapters/postgresql_adapter.rb:223:in `initialize'
activerecord (5.2.6) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `new'
activerecord (5.2.6) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `postgresql_connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:830:in `new_connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:874:in `checkout_new_connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:853:in `try_to_checkout_new_connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:814:in `acquire_connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:538:in `checkout'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'
activerecord (5.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:1033:in `retrieve_connection'
activerecord (5.2.6) lib/active_record/connection_handling.rb:118:in `retrieve_connection'
activerecord (5.2.6) lib/active_record/connection_handling.rb:90:in `connection'
activerecord (5.2.6) lib/active_record/migration.rb:554:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.6) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
  [1m[35m (561.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (325.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/orders" for ::1 at 2021-05-08 21:09:07 -0300
  
ActionController::RoutingError (uninitialized constant OrdersController):
  
activesupport (5.2.6) lib/active_support/inflector/methods.rb:283:in `const_get'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:283:in `block in constantize'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `each'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `inject'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `constantize'
actionpack (5.2.6) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (5.2.6) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (5.2.6) lib/action_dispatch/routing/route_set.rb:46:in `controller'
actionpack (5.2.6) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:52:in `block in serve'
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:35:in `each'
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:35:in `serve'
actionpack (5.2.6) lib/action_dispatch/routing/route_set.rb:840:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (5.2.6) lib/active_record/migration.rb:559:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.6) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/orders" for ::1 at 2021-05-08 21:11:27 -0300
  
ActionController::RoutingError (No route matches [POST] "/orders"):
  
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/api/orders" for ::1 at 2021-05-08 21:11:48 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:4: syntax error, unexpected ')', expecting keyword_end
...erOperation.call(order_params))
...                              ^):
  
app/controllers/api/orders_controller.rb:4: syntax error, unexpected ')', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-08 21:12:16 -0300
  
LoadError (Unable to autoload constant Api::OrdersController, expected /home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb to define it):
  
activesupport (5.2.6) lib/active_support/dependencies.rb:511:in `load_missing_constant'
activesupport (5.2.6) lib/active_support/dependencies.rb:195:in `const_missing'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:285:in `const_get'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:285:in `block in constantize'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `each'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `inject'
activesupport (5.2.6) lib/active_support/inflector/methods.rb:281:in `constantize'
activesupport (5.2.6) lib/active_support/dependencies.rb:582:in `get'
activesupport (5.2.6) lib/active_support/dependencies.rb:613:in `constantize'
actionpack (5.2.6) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (5.2.6) lib/action_dispatch/http/parameters.rb:101:in `binary_params_for?'
actionpack (5.2.6) lib/action_dispatch/http/parameters.rb:92:in `set_binary_encoding'
actionpack (5.2.6) lib/action_dispatch/http/parameters.rb:69:in `path_parameters='
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:35:in `each'
actionpack (5.2.6) lib/action_dispatch/journey/router.rb:35:in `serve'
actionpack (5.2.6) lib/action_dispatch/routing/route_set.rb:840:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (5.2.6) lib/active_record/migration.rb:559:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.6) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/api/orders" for ::1 at 2021-05-08 21:13:37 -0300
Processing by Api::OrdersController#create as */*
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms)


  
NoMethodError (undefined method `pry' for #<Binding:0x000055ffedd48e40>
Did you mean?  try):
  
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:14:34 -0300
Processing by Api::OrdersController#create as */*
Completed 500 Internal Server Error in 105430ms (ActiveRecord: 0.0ms)


  
NameError (uninitialized constant Api::OrdersController::Operations):
  
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:16:31 -0300
Processing by Api::OrdersController#create as */*
Completed 500 Internal Server Error in 36899ms (ActiveRecord: 0.0ms)


  
NameError (uninitialized constant Api::OrdersController::Operations):
  
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:18:59 -0300
Processing by Api::OrdersController#create as */*
Completed 500 Internal Server Error in 259596ms (ActiveRecord: 0.0ms)


  
NameError (uninitialized constant Api::OrdersController::Operations):
  
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
Started POST "/api/orders" for ::1 at 2021-05-08 21:29:05 -0300
Processing by Api::OrdersController#create as */*
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 40844ms (ActiveRecord: 0.6ms)


  
NameError (undefined local variable or method `organizers' for Operations::Orders::CreateOrderOperation:Class):
  
lib/operations/orders/create_order_operation.rb:22:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:29:50 -0300
Processing by Api::OrdersController#create as */*
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 6588ms (ActiveRecord: 0.8ms)


  
NoMethodError (undefined method `errors' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:10:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:39:35 -0300
Processing by Api::OrdersController#create as */*
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.6ms)


  
NoMethodError (undefined method `each_pair' for "teste":String
Did you mean?  each_char):
  
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:41:11 -0300
Processing by Api::OrdersController#create as */*
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 121679ms (ActiveRecord: 0.6ms)


  
NoMethodError (undefined method `each_pair' for "teste":String
Did you mean?  each_char):
  
lib/operations/orders/create_order_operation.rb:22:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 21:44:43 -0300
Processing by Api::OrdersController#create as */*
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 29526ms (ActiveRecord: 0.9ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:30:15 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.5ms)


  
NameError (uninitialized constant Interactors::SendOrder):
  
lib/organizers/create_order.rb:4:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:31:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.9ms)


  
NoMethodError (undefined method `ParseOrder' for Interactors:Module):
  
lib/organizers/create_order.rb:4:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:32:40 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.6ms)


  
NoMethodError (undefined method `ParseOrder' for Interactors:Module):
  
lib/organizers/create_order.rb:4:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:32:53 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.5ms)


  
NoMethodError (undefined method `ParseOrder' for Interactors:Module):
  
lib/organizers/create_order.rb:4:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:33:38 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 21294ms (ActiveRecord: 0.7ms)


  
NoMethodError (undefined method `ParseOrder' for Interactors:Module):
  
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:35:06 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 14133ms (ActiveRecord: 0.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:35:59 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 12203ms (ActiveRecord: 0.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:36:29 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 21149ms (ActiveRecord: 0.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-08 22:37:12 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 73608ms (ActiveRecord: 0.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
  [1m[35m (10.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to Orders (20210509014115)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/migrate/20210509014115_orders.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014115"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.7ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 02:12:11.558787"], ["updated_at", "2021-05-09 02:12:11.558787"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("date_created") VALUES ($1) RETURNING "id"[0m  [["date_created", "2021-05-09 02:13:53.700247"]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to Orders (20210509014115)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "orders"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014115"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrders (20210509014150)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrders (20210509014150)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/migrate/20210509014150_create_orders.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014150"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrderItem Create (1.5ms)[0m  [1m[32mINSERT INTO "order_items" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "phones"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE "neighborhoods"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "countries"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE "states"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "cities"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE "receiver_addresses"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "buyers"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "shippings"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "payments"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE "order_items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Create (0.8ms)[0m  [1m[32mINSERT INTO "orders" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1 LIMIT $2[0m  [["order_id", 1], ["LIMIT", 11]]
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 1]]
  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.8ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mItem Create (1.6ms)[0m  [1m[32mINSERT INTO "items" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.9ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrderItem Update (0.4ms)[0m  [1m[33mUPDATE "order_items" SET "item_id" = $1 WHERE "order_items"."id" = $2[0m  [["item_id", 1], ["id", 1]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrderItem Load (1.1ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.8ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.8ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.9ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (1.0ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.2ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (1.0ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.9ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" ORDER BY "order_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mItem Load (0.7ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mItem Load (0.7ms)[0m  [1m[34mSELECT  "items".* FROM "items" ORDER BY "items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mItem Load (0.7ms)[0m  [1m[34mSELECT  "items".* FROM "items" ORDER BY "items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrderItem Load (0.7ms)[0m  [1m[34mSELECT  "order_items".* FROM "order_items" WHERE "order_items"."item_id" = $1 LIMIT $2[0m  [["item_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mPayment Create (0.8ms)[0m  [1m[32mINSERT INTO "payments" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 1]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mPayment Create (0.3ms)[0m  [1m[32mINSERT INTO "payments" ("order_id") VALUES ($1) RETURNING "id"[0m  [["order_id", 2]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (0.9ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrder Load (0.9ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mOrder Load (0.9ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPayment Load (0.9ms)[0m  [1m[34mSELECT  "payments".* FROM "payments" WHERE "payments"."order_id" = $1 LIMIT $2[0m  [["order_id", 1], ["LIMIT", 11]]
  [1m[36mOrder Load (0.9ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 1]]
  [1m[36mShipping Load (1.0ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mShipping Create (1.1ms)[0m  [1m[32mINSERT INTO "shippings" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mShipping Load (0.7ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" WHERE "shippings"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("shipping_id") VALUES ($1) RETURNING "id"[0m  [["shipping_id", 1]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (1.0ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (0.7ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" WHERE "shippings"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mShipping Load (0.7ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (0.3ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (0.8ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (0.8ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (1.0ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mShipping Load (1.0ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mShipping Update (0.9ms)[0m  [1m[33mUPDATE "shippings" SET "receiver_address_id" = $1 WHERE "shippings"."id" = $2[0m  [["receiver_address_id", 1], ["id", 1]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mShipping Load (0.8ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (1.2ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" WHERE "receiver_addresses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mShipping Load (0.9ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mReceiverAddress Create (0.5ms)[0m  [1m[32mINSERT INTO "receiver_addresses" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mShipping Load (0.8ms)[0m  [1m[34mSELECT  "shippings".* FROM "shippings" ORDER BY "shippings"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.8ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" WHERE "receiver_addresses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Create (1.4ms)[0m  [1m[32mINSERT INTO "cities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCountry Create (1.2ms)[0m  [1m[32mINSERT INTO "countries" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mNeighborhood Create (1.3ms)[0m  [1m[32mINSERT INTO "neighborhoods" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mReceiverAddress Load (0.6ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.9ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mReceiverAddress Update (0.8ms)[0m  [1m[33mUPDATE "receiver_addresses" SET "city_id" = $1, "state_id" = $2, "country_id" = $3, "neighborhood_id" = $4 WHERE "receiver_addresses"."id" = $5[0m  [["city_id", 1], ["state_id", 1], ["country_id", 1], ["neighborhood_id", 1], ["id", 1]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mReceiverAddress Load (1.0ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (1.0ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.9ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.5ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.9ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mState Load (0.7ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReceiverAddress Load (1.1ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (1.1ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReceiverAddress Load (0.9ms)[0m  [1m[34mSELECT  "receiver_addresses".* FROM "receiver_addresses" ORDER BY "receiver_addresses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBuyer Create (1.5ms)[0m  [1m[32mINSERT INTO "buyers" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mOrder Update (0.5ms)[0m  [1m[33mUPDATE "orders" SET "buyer_id" = $1 WHERE "orders"."id" = $2[0m  [["buyer_id", 1], ["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mBuyer Load (0.3ms)[0m  [1m[34mSELECT  "buyers".* FROM "buyers" WHERE "buyers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mPhone Load (0.3ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" ORDER BY "phones"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mPhone Create (1.3ms)[0m  [1m[32mINSERT INTO "phones" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mPhone Load (0.5ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" WHERE "phones"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBuyer Create (0.6ms)[0m  [1m[32mINSERT INTO "buyers" ("phone_id") VALUES ($1) RETURNING "id"[0m  [["phone_id", 1]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBuyer Load (0.9ms)[0m  [1m[34mSELECT  "buyers".* FROM "buyers" ORDER BY "buyers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPhone Load (0.7ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" WHERE "phones"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started POST "/api/orders" for ::1 at 2021-05-09 09:04:24 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :store_id, :date_created, :date_closed, :last_updated, :total_amount, :total_shipping, :total_amount_with_shipping, :paid_amount, :expiration_date, :order_items, :payments, :shipping, :status, :buyer, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 24086ms (ActiveRecord: 4.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:11:06 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:19: syntax error, unexpected ',', expecting =>
...item: [:id, :title], :quantity, :unit_price, :full_unit_pric...
...                              ^):
  
app/controllers/api/orders_controller.rb:19: syntax error, unexpected ',', expecting =>
Started POST "/api/orders" for ::1 at 2021-05-09 09:13:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameters: :item, :quantity, :full_unit_price
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 91132ms (ActiveRecord: 5.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:16:38 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :payments, :shipping, :status, :buyer, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 364456ms (ActiveRecord: 4.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:22:47 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :shipping, :status, :buyer, :order
Unpermitted parameter: :quantity
Unpermitted parameters: :last_updated, :shipping, :status, :buyer, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 59695ms (ActiveRecord: 6.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:30:42 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:23: syntax error, unexpected tIDENTIFIER, expecting ')'
                  shipping: [:id, :shipment_type, :date...
                  ^~~~~~~~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected tIDENTIFIER, expecting ']'
...                           city: [:name], state:[:name], cou...
...                           ^~~~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
...                 city: [:name], state:[:name], country:[:id,...
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
...  city: [:name], state:[:name], country:[:id, :name],
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
...:[:name], country:[:id, :name],
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting keyword_end
...     neighborhood:[:id, :name], :latitude, :longitude, :rece...
...                              ^):
  
app/controllers/api/orders_controller.rb:23: syntax error, unexpected tIDENTIFIER, expecting ')'
app/controllers/api/orders_controller.rb:25: syntax error, unexpected tIDENTIFIER, expecting ']'
app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:32:02 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
...orhood:[:id, :name], :latitude, :longitude, :receiver_phone]...
...                              ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
Started POST "/api/orders" for ::1 at 2021-05-09 09:35:53 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
...rhood: [:id, :name], :latitude, :longitude, :receiver_phone
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
...                              ] 
...                              ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:37:17 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 7410ms (ActiveRecord: 5.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:39:18 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
...rhood: [:id, :name], :latitude, :longitude, :receiver_phone
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
...                              ] 
...                              ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:39:38 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
...rhood: [:id, :name], :latitude, :longitude, :receiver_phone
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:28: syntax error, unexpected ']', expecting keyword_end
                            ]              
                            ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
app/controllers/api/orders_controller.rb:28: syntax error, unexpected ']', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:39:55 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
...rhood: [:id, :name], :latitude, :longitude, :receiver_phone
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
...                              ] ]
...                              ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected ',', expecting =>
app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:41:31 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :receiver_address
Unpermitted parameters: :last_updated, :status, :buyer, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 13534ms (ActiveRecord: 4.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:42:15 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4784ms (ActiveRecord: 2.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:42:40 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 17151ms (ActiveRecord: 3.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:43:00 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 3882ms (ActiveRecord: 6.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:43:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4567ms (ActiveRecord: 4.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:43:54 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:26: syntax error, unexpected '\n', expecting =>
...orhood: [:id, :name], :latitude
...                               ^):
  
app/controllers/api/orders_controller.rb:26: syntax error, unexpected '\n', expecting =>
Started POST "/api/orders" for ::1 at 2021-05-09 09:44:31 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4822ms (ActiveRecord: 3.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:44:56 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:24: syntax error, unexpected ',', expecting ']'
...ddress: [ :id, :address_line, , :latitude, :longitude, :rece...
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
...                city: [:name] , state: :name , country: [:id...
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
...:name , country: [:id , :name],
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
...                              ] 
...                              ^):
  
app/controllers/api/orders_controller.rb:24: syntax error, unexpected ',', expecting ']'
app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
app/controllers/api/orders_controller.rb:25: syntax error, unexpected ',', expecting keyword_end
app/controllers/api/orders_controller.rb:27: syntax error, unexpected ']', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:45:26 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4647ms (ActiveRecord: 3.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:45:48 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameters: :address_line, :street_name, :longitude, :receiver_phone
Unpermitted parameters: :last_updated, :status, :buyer, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 10916ms (ActiveRecord: 3.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:46:18 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 16074ms (ActiveRecord: 3.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:46:38 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4108ms (ActiveRecord: 3.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:47:30 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :status, :buyer, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 14576ms (ActiveRecord: 3.5ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:50:08 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:30: syntax error, unexpected tSYMBEG, expecting ')'
                  :status
                  ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:32: syntax error, unexpected ')', expecting keyword_end
                  )
                  ^):
  
app/controllers/api/orders_controller.rb:30: syntax error, unexpected tSYMBEG, expecting ')'
app/controllers/api/orders_controller.rb:32: syntax error, unexpected ')', expecting keyword_end
Started POST "/api/orders" for ::1 at 2021-05-09 09:50:17 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:30: syntax error, unexpected '\n', expecting =>
                  :status
                         ^):
  
app/controllers/api/orders_controller.rb:30: syntax error, unexpected '\n', expecting =>
Started POST "/api/orders" for ::1 at 2021-05-09 09:50:37 -0300
  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/app/controllers/api/orders_controller.rb:29: syntax error, unexpected '\n', expecting =>
...                     ], :status
...                               ^):
  
app/controllers/api/orders_controller.rb:29: syntax error, unexpected '\n', expecting =>
Started POST "/api/orders" for ::1 at 2021-05-09 09:51:10 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 8906ms (ActiveRecord: 4.3ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:52:02 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4066ms (ActiveRecord: 3.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:53:19 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :email, :phone, :first_name, :last_name, :billing_info
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 27442ms (ActiveRecord: 3.5ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 09:56:59 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 18408ms (ActiveRecord: 3.5ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:06:22 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 128462ms (ActiveRecord: 5.3ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:08:35 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Completed 500 Internal Server Error in 13959ms (ActiveRecord: 2.6ms)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/api/orders_controller.rb:15:in `order_params'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:09:11 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 2.6ms)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/api/orders_controller.rb:14:in `order_params'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:09:12 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
app/controllers/api/orders_controller.rb:14:in `order_params'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:09:31 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 640515ms (ActiveRecord: 2.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:20:20 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 348532ms (ActiveRecord: 3.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:26:12 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 14822ms (ActiveRecord: 15.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:32:25 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:18
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 30ms (ActiveRecord: 10.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:32:44 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:18
  [1m[35m (3.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 11662ms (ActiveRecord: 13.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:34:54 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:18
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 13784ms (ActiveRecord: 8.3ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:35:37 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 15310ms (ActiveRecord: 10.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:36:12 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (2.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 14247ms (ActiveRecord: 14.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:36:40 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 19ms (ActiveRecord: 8.9ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:36:59 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 23ms (ActiveRecord: 9.9ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:37:07 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ (pry):81
  [1m[36mPhone Create (1.1ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ (pry):82
  [1m[36mPhone Create (1.2ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ (pry):83
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ (pry):84
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 110579ms (ActiveRecord: 19.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:39:20 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 276376ms (ActiveRecord: 12.5ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:44:00 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 545226ms (ActiveRecord: 19.0ms)


  
ActiveRecord::AssociationTypeMismatch (Phone(#47401096523880) expected, got {"area_code"=>41, "number"=>"999999999"} which is an instance of ActiveSupport::HashWithIndifferentAccess(#47401085668960)):
  
lib/interactors/parse_order.rb:33:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:53:20 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :phone, :billing_info
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" DEFAULT VALUES RETURNING "id"[0m
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" DEFAULT VALUES RETURNING "id"[0m
  â†³ lib/interactors/parse_order.rb:26
  [1m[36mPhone Load (0.4ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" ORDER BY "phones"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):2
  [1m[36mCACHE Phone Load (0.0ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" ORDER BY "phones"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):4
  [1m[36mCACHE Phone Load (0.0ms)[0m  [1m[34mSELECT  "phones".* FROM "phones" ORDER BY "phones"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):5
  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 342843ms (ActiveRecord: 19.4ms)


  
NameError (undefined local variable or method `phone' for #<Interactors::ParseOrder:0x000055b0a31d0f48>):
  
lib/interactors/parse_order.rb:34:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:3:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 10:59:08 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :phone, :billing_info
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):36
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):36
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :phone, :billing_info
Unpermitted parameters: :last_updated, :order
  [1m[35m (3.3ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):37
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):37
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :phone, :billing_info
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" DEFAULT VALUES RETURNING "id"[0m
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" DEFAULT VALUES RETURNING "id"[0m
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 223584ms (ActiveRecord: 24.0ms)


  
NameError (undefined local variable or method `phone' for #<Interactors::ParseOrder:0x000055b0a27960f0>):
  
lib/interactors/parse_order.rb:34:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:02:56 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 13279ms (ActiveRecord: 19.3ms)


  
ActiveRecord::AssociationTypeMismatch (Phone(#69973680522700) expected, got {"area_code"=>41, "number"=>"999999999"} which is an instance of ActiveSupport::HashWithIndifferentAccess(#47108558458620)):
  
lib/interactors/parse_order.rb:33:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:03:23 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 456450ms (ActiveRecord: 18.7ms)


  
ActiveRecord::AssociationTypeMismatch (Phone(#69973681665780) expected, got {"area_code"=>41, "number"=>"999999999"} which is an instance of ActiveSupport::HashWithIndifferentAccess(#47108558458620)):
  
lib/interactors/parse_order.rb:33:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:5:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:11:03 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 174234ms (ActiveRecord: 15.7ms)


  
ActiveRecord::AssociationTypeMismatch (Phone(#69973680939500) expected, got {"area_code"=>41, "number"=>"999999999"} which is an instance of ActiveSupport::HashWithIndifferentAccess(#47108558458620)):
  
lib/interactors/parse_order.rb:33:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:14:00 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 77992ms (ActiveRecord: 15.1ms)


  
NameError (undefined local variable or method `phone' for #<Interactors::ParseOrder:0x00007f4808c48ce8>):
  
lib/interactors/parse_order.rb:34:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:15:21 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:20
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:26
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 24995ms (ActiveRecord: 17.2ms)


  
NameError (undefined local variable or method `phone' for #<Interactors::ParseOrder:0x00007f4808f0f4b8>):
  
lib/interactors/parse_order.rb:34:in `initialize_buyer'
lib/interactors/parse_order.rb:16:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:20:56 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 41ms (ActiveRecord: 14.4ms)


  
NoMethodError (undefined method `payments' for #<Interactors::ParseOrder:0x00007f4808cee6c0>):
  
lib/interactors/parse_order.rb:43:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:21:16 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 61ms (ActiveRecord: 19.9ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'status' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "phones"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "neighborhoods"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE "countries"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE "states"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.8ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (3.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE "cities"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.7ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "receiver_addresses"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE "items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE "buyers"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE "shippings"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "phones"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "neighborhoods"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "countries"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "states"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "cities"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE "receiver_addresses"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE "buyers"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "shippings"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:23:46 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.2ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 72ms (ActiveRecord: 26.0ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'status' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5015.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5015.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (341.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:87
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:87
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:92
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:92
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:107
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:107
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:113
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:113
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:25:13.876433"], ["updated_at", "2021-05-09 14:25:13.876433"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (25.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:87
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:87
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:92
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:92
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:107
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:107
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:113
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:113
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:25:14.054567"], ["updated_at", "2021-05-09 14:25:14.054567"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:25:14.058457"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:25:31 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.9ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 104ms (ActiveRecord: 22.3ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'status' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (322.1ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:87
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:87
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:92
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:92
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:107
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:107
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:113
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:113
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:27:49.524743"], ["updated_at", "2021-05-09 14:27:49.524743"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (6.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:87
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:87
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:92
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:92
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:107
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:107
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:113
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:113
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.5ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 14:27:49.684700"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:27:49.689460"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:28:09 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 109ms (ActiveRecord: 22.9ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'status' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE "phones"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "neighborhoods"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "countries"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "states"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "cities"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "receiver_addresses"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (4.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "buyers"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "shippings"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "payments"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "order_items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:30:27 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 59ms (ActiveRecord: 19.7ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'payment_type' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "phones"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "neighborhoods"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "countries"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "states"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "cities"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE "receiver_addresses"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "items"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.5ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE "buyers"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mDROP TABLE "billing_infos"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5013.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (122.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (107.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (319.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (325.1ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:27
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:27
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:31
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:31
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:40
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:40
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:44
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:44
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:52
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:52
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:67
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:67
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:83
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:83
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:103
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:103
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:109
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:109
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015659)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:32:38.996820"], ["updated_at", "2021-05-09 14:32:38.996820"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (14.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:27
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:27
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:31
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:31
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:40
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:40
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:44
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:44
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:52
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:52
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:67
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:67
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:83
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:83
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:103
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:103
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:109
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:109
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015659)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:32:39.158888"], ["updated_at", "2021-05-09 14:32:39.158888"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:32:39.163295"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:27
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:27
  [1m[35m (4.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:31
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:31
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:40
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:40
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:44
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:44
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:52
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:52
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:67
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:67
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:83
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:83
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:103
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:103
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:109
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:109
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:27
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:27
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:31
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:31
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:40
  [1m[35m (10.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:40
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:44
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:44
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:52
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:52
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:67
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:67
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:83
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:83
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:103
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:103
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:109
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:109
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 14:32:45.631422"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:32:45.635241"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:33:03 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate RAILS_ENV=development

):
  
activerecord (5.2.6) lib/active_record/migration.rb:579:in `check_pending!'
activerecord (5.2.6) lib/active_record/migration.rb:556:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.6) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:33:16 -0300
  [1m[35m (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 123ms (ActiveRecord: 23.5ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'payment_type' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (119.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (336.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (309.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:33:32.268328"], ["updated_at", "2021-05-09 14:33:32.268328"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (13.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:33:32.454468"], ["updated_at", "2021-05-09 14:33:32.454468"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:33:32.459861"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:34:12 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 119ms (ActiveRecord: 22.5ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'payment_type' for Payment.):
  
lib/interactors/parse_order.rb:45:in `block in initialize_payments'
lib/interactors/parse_order.rb:44:in `each'
lib/interactors/parse_order.rb:44:in `initialize_payments'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (117.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (305.1ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (332.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (4.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:34:26.009117"], ["updated_at", "2021-05-09 14:34:26.009117"]]
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (11.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (11.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_types" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:34:26.191875"], ["updated_at", "2021-05-09 14:34:26.191875"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:34:26.195513"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (309.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (330.9ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 14:34:47.602715"], ["updated_at", "2021-05-09 14:34:47.602715"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2021-05-09 14:34:47.633890"], ["updated_at", "2021-05-09 14:34:47.633890"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrders (20210509014150)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/migrate/20210509014150_create_orders.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014150"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (3.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:35:08 -0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.0ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:21
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:27
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 95ms (ActiveRecord: 21.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:35:43 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:23
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[35m (4.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 62464ms (ActiveRecord: 27.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:46:05 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:24
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:30
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:48
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 90ms (ActiveRecord: 28.1ms)


  
NameError (undefined local variable or method `order_itens' for #<Interactors::ParseOrder:0x00007f358802e490>
Did you mean?  order_items
               order_item):
  
lib/interactors/parse_order.rb:62:in `block in initialize_order_items'
lib/interactors/parse_order.rb:57:in `each'
lib/interactors/parse_order.rb:57:in `initialize_order_items'
lib/interactors/parse_order.rb:18:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:46:42 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:24
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:30
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:48
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 101ms (ActiveRecord: 30.6ms)


  
NoMethodError (undefined method `save' for #<Array:0x00007f35880250e8>):
  
lib/interactors/parse_order.rb:63:in `block in initialize_order_items'
lib/interactors/parse_order.rb:57:in `each'
lib/interactors/parse_order.rb:57:in `initialize_order_items'
lib/interactors/parse_order.rb:18:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:47:00 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:24
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:30
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:48
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:62
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 34683ms (ActiveRecord: 31.5ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 11:47:52 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:24
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:30
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:48
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 78ms (ActiveRecord: 26.1ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "items_pkey"
DETAIL:  Key (id)=(0) already exists.
: INSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"):
  
lib/interactors/parse_order.rb:58:in `block in initialize_order_items'
lib/interactors/parse_order.rb:57:in `each'
lib/interactors/parse_order.rb:57:in `initialize_order_items'
lib/interactors/parse_order.rb:18:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (4.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (3.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (17.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 14:48:26.973174"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 14:48:26.977909"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 11:48:33 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:24
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:30
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:48
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 75142ms (ActiveRecord: 33.6ms)


  
NoMethodError (undefined method `except' for #<OrderItem:0x00007f0dd4c64b78>):
  
lib/interactors/parse_order.rb:61:in `block in initialize_order_items'
lib/interactors/parse_order.rb:57:in `each'
lib/interactors/parse_order.rb:57:in `initialize_order_items'
lib/interactors/parse_order.rb:18:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:01:11 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:28
  [1m[36mPhone Create (1.0ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:34
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Create (1.0ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:87
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:40
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:46
  [1m[36mCountry Create (0.9ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:52
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 137ms (ActiveRecord: 48.8ms)


  
NameError (undefined local variable or method `neighborhood' for #<Interactors::ParseOrder:0x00007f0de4063828>):
  
lib/interactors/parse_order.rb:59:in `initialize_neighborhood'
lib/interactors/parse_order.rb:22:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:01:39 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:28
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:34
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:87
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:40
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:46
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:52
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:58
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 25517ms (ActiveRecord: 42.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:09:51 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (1.0ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 80ms (ActiveRecord: 26.5ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "items_pkey"
DETAIL:  Key (id)=(0) already exists.
: INSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"):
  
lib/interactors/parse_order.rb:102:in `block in initialize_order_items'
lib/interactors/parse_order.rb:101:in `each'
lib/interactors/parse_order.rb:101:in `initialize_order_items'
lib/interactors/parse_order.rb:18:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5016.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (313.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (313.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:10:15.216845"], ["updated_at", "2021-05-09 15:10:15.216845"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:10:15.370861"], ["updated_at", "2021-05-09 15:10:15.370861"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.5ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:10:15.375667"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (4.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 15:10:18.507911"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:10:18.513219"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 12:10:37 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (1.0ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.9ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (1.9ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 200ms (ActiveRecord: 43.6ms)


  
NameError (uninitialized constant Interactors::ParseOrder::ReceiverAddres):
  
lib/interactors/parse_order.rb:65:in `initialize_receiver_address'
lib/interactors/parse_order.rb:23:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:11:14 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 161ms (ActiveRecord: 46.2ms)


  
NoMethodError (undefined method `phone=' for #<ReceiverAddress:0x000055f2e5c3bf80>):
  
lib/interactors/parse_order.rb:71:in `initialize_receiver_address'
lib/interactors/parse_order.rb:23:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:12:56 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 147ms (ActiveRecord: 46.4ms)


  
NoMethodError (undefined method `id' for nil:NilClass):
  
lib/interactors/parse_order.rb:71:in `initialize_receiver_address'
lib/interactors/parse_order.rb:23:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:13:16 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.8ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 211ms (ActiveRecord: 59.0ms)


  
ActiveRecord::AssociationTypeMismatch (Neighborhood(#69977198957900) expected, got 4 which is an instance of Integer(#47250848439460)):
  
lib/interactors/parse_order.rb:71:in `initialize_receiver_address'
lib/interactors/parse_order.rb:23:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:13:44 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.3ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[36mCity Load (0.6ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 170ms (ActiveRecord: 47.1ms)


  
NoMethodError (undefined method `prys' for #<Binding:0x00007f49a4d37828>
Did you mean?  pry):
  
lib/interactors/parse_order.rb:25:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:14:01 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:29
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:35
  [1m[36mOrder Load (0.2ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:102
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:106
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:41
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:47
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:59
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:73
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 28378ms (ActiveRecord: 52.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (300.8ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (123.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (121.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (316.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (319.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:21:43.544801"], ["updated_at", "2021-05-09 15:21:43.544801"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (15.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (12.6ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:21:43.734040"], ["updated_at", "2021-05-09 15:21:43.734040"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:21:43.737560"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 12:22:28 -0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:38
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:44
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:100
  [1m[36mItem Create (1.2ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:111
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mCity Create (1.1ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:50
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:56
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:62
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:82
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:82
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:82
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:82
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:32
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 34291ms (ActiveRecord: 58.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:30:36 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 79ms (ActiveRecord: 24.3ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "items_pkey"
DETAIL:  Key (id)=(0) already exists.
: INSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"):
  
lib/interactors/parse_order.rb:110:in `block in initialize_order_items'
lib/interactors/parse_order.rb:109:in `each'
lib/interactors/parse_order.rb:109:in `initialize_order_items'
lib/interactors/parse_order.rb:17:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (3033.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (329.9ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (312.9ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.6ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:30:48.292520"], ["updated_at", "2021-05-09 15:30:48.292520"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:30:48.454300"], ["updated_at", "2021-05-09 15:30:48.454300"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:30:48.458692"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (5.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (4.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (4.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 15:30:59.986546"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:30:59.990645"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:07 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (2.1ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 219ms (ActiveRecord: 52.9ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:28 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.9ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.6ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 63ms (ActiveRecord: 9.1ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:30 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (3.8ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.8ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (4.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 60ms (ActiveRecord: 15.7ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:31 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.6ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.3ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 50ms (ActiveRecord: 9.5ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.7ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.7ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.6ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.3ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 50ms (ActiveRecord: 7.9ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:33 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.1ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (1.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (1.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.8ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 62ms (ActiveRecord: 10.5ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:34 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (2.2ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.2ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.3ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 43ms (ActiveRecord: 8.8ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:31:35 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mPhone Create (1.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mOrder Load (2.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:99
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mItem Load (1.2ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:114
  [1m[36mCity Create (0.7ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (1.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:67
  [1m[36mCity Load (0.2ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:81
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:124
  [1m[36mPayment Load (0.2ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:125
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 68ms (ActiveRecord: 12.4ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:129:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:45:04 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (3.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:39
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:101
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:112
  [1m[36mItem Load (0.9ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:51
  [1m[36mState Create (0.7ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:69
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mCountry Load (0.8ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mNeighborhood Load (1.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:33
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:126
  [1m[36mPayment Load (0.7ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:127
  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 403ms (ActiveRecord: 88.7ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:131:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:45:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>43444211797, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:39
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:101
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:112
  [1m[36mItem Load (0.8ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:51
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:69
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 43444211797], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:33
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:126
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:127
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 80434ms (ActiveRecord: 86.3ms)


  
ActiveModel::RangeError (43444211797 is out of range for ActiveModel::Type::Integer with limit 4 bytes):
  
lib/interactors/parse_order.rb:132:in `initialize_order'
lib/interactors/parse_order.rb:24:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:47:12 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:39
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:101
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:112
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:51
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:69
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:83
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:33
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:126
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:127
  [1m[36mOrder Create (1.7ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ (pry):1
  [1m[36mOrderItem Create (1.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ (pry):1
  [1m[36mPayment Create (1.4ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ (pry):1
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 31590ms (ActiveRecord: 58.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "orders"[0m
  [1m[36mOrder Load (1.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/api/orders" for ::1 at 2021-05-09 12:53:24 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 9ms (ActiveRecord: 4.3ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:134: syntax error, unexpected tSTRING_BEG, expecting ']'
    	"initialize_order_items", "ini...
    	^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
    	"initialize_order_items", "initialize_city", "initiali...
    	                        ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
...rder_items", "initialize_city", "initialize_state", "initial...
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
...lize_city", "initialize_state", "initialize_country",
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
...e_state", "initialize_country",
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
    	"initialize_neighborhood", "initialize_receiver_address...
    	                         ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
... "initialize_receiver_address", "initialize_shipping", "init...
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
...ddress", "initialize_shipping", "initialize_order"]
...                              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/parse_order.rb:135: syntax error, unexpected ']', expecting keyword_end
..._shipping", "initialize_order"]
...                              ^):
  
lib/interactors/parse_order.rb:134: syntax error, unexpected tSTRING_BEG, expecting ']'
lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:134: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:135: syntax error, unexpected ',', expecting keyword_end
lib/interactors/parse_order.rb:135: syntax error, unexpected ']', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 12:54:00 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mPhone Create (4.9ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:93
  [1m[36mPayment Create (1.0ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:93
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 82ms (ActiveRecord: 26.8ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:93:in `block in initialize_payments'
lib/interactors/parse_order.rb:92:in `each'
lib/interactors/parse_order.rb:92:in `initialize_payments'
lib/interactors/parse_order.rb:14:in `block in initialize_entities'
lib/interactors/parse_order.rb:13:in `each'
lib/interactors/parse_order.rb:13:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5014.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (125.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (302.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (343.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:54:21.993676"], ["updated_at", "2021-05-09 15:54:21.993676"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (11.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (11.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (13.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 15:54:22.180177"], ["updated_at", "2021-05-09 15:54:22.180177"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 15:54:22.184336"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 12:55:17 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:93
  [1m[36mItem Create (1.0ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:104
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:55
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:61
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:75
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:75
  [1m[36mCountry Load (0.7ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:75
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:75
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:118
  [1m[36mPayment Load (0.3ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:119
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:123
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:123
  [1m[36mPayment Create (0.4ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:123
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 14479ms (ActiveRecord: 59.3ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (109.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (320.8ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (313.8ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:10:40.338741"], ["updated_at", "2021-05-09 16:10:40.338741"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (18.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (11.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (12.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:10:40.530632"], ["updated_at", "2021-05-09 16:10:40.530632"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:10:40.534287"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (4.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 16:10:48.675243"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:10:48.680470"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 13:11:38 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (1.1ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.8ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.6ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.5ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 1847369ms (ActiveRecord: 55.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 13:42:32 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (2.8ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 90ms (ActiveRecord: 26.9ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1923.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (110.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (313.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (331.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (22.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (12.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (23.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (20.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (12.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (13.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (17.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (25.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (2.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (11.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:42:56.091083"], ["updated_at", "2021-05-09 16:42:56.091083"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (21.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (15.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (15.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (23.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (12.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (12.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (12.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (16.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (14.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (16.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (16.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:42:56.353547"], ["updated_at", "2021-05-09 16:42:56.353547"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:42:56.356917"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 16:43:04.052062"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:43:04.055717"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 13:43:20 -0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.9ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.8ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (1.0ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.9ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 179759ms (ActiveRecord: 66.5ms)


  
NoMethodError (undefined method `deliveryFee' for #<Order:0x000055ea5001f208>):
  
lib/interactors/build_payload.rb:20:in `parsed_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 13:46:31 -0300
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.8ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.6ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.6ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.7ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.3ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.4ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.4ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 37297ms (ActiveRecord: 62.8ms)


  
NoMethodError (undefined method `city' for #<State id: nil, name: "SÃ£o Paulo">):
  
lib/interactors/build_payload.rb:25:in `parsed_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 13:47:15 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.3ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.7ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 119868ms (ActiveRecord: 60.7ms)


  
NoMethodError (undefined method `name' for nil:NilClass):
  
lib/interactors/build_payload.rb:27:in `parsed_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 13:49:22 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.7ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.7ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 63394ms (ActiveRecord: 54.9ms)


  
NoMethodError (undefined method `street_name' for #<Order:0x000055b698be4728>):
  
lib/interactors/build_payload.rb:27:in `parsed_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 13:50:34 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.8ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 143915ms (ActiveRecord: 75.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (117.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (305.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (316.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:53:14.754409"], ["updated_at", "2021-05-09 16:53:14.754409"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (11.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (20.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 16:53:14.935583"], ["updated_at", "2021-05-09 16:53:14.935583"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:53:14.940868"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 16:53:19.511896"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.7ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 16:53:19.515907"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 13:59:00 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 9ms (ActiveRecord: 3.0ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:41: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "items":{
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:41: syntax error, unexpected ':', expecting keyword_end
		    "items":{
		           ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:46: syntax error, unexpected '\n', expecting =>
		    	end
		    	   ^):
  
lib/interactors/build_payload.rb:41: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:41: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:46: syntax error, unexpected '\n', expecting =>
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:06:09 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 11ms (ActiveRecord: 4.5ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:51: syntax error, unexpected ':', expecting =>
   					"quantity" : item.quantity
   					           ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:52: syntax error, unexpected '}', expecting keyword_end
   				}
   				^):
  
lib/interactors/build_payload.rb:51: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:52: syntax error, unexpected '}', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:06:51 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 8ms (ActiveRecord: 3.7ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:53: syntax error, unexpected '\n', expecting =>
   			end
   			   ^):
  
lib/interactors/build_payload.rb:53: syntax error, unexpected '\n', expecting =>
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:07:49 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 9ms (ActiveRecord: 3.2ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:52: syntax error, unexpected ':', expecting =>
   					"quantity" : item.quantity
   					           ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:53: syntax error, unexpected '}', expecting keyword_end
   				}
   				^):
  
lib/interactors/build_payload.rb:52: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:53: syntax error, unexpected '}', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:08:31 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 8ms (ActiveRecord: 4.2ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:53: syntax error, unexpected ':', expecting =>
	   					"quantity" : item.quantity
	   					           ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:54: syntax error, unexpected '}', expecting keyword_end
	   				}
	   				^):
  
lib/interactors/build_payload.rb:53: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:54: syntax error, unexpected '}', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:14:19 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (1.2ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (1.9ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (1.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (1.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (2.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (1.1ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (2.8ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (1.8ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 18267ms (ActiveRecord: 74.5ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
lib/interactors/build_payload.rb:51:in `items_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:14:53 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (1.2ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (1.0ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (1.0ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.8ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.4ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 21675ms (ActiveRecord: 61.9ms)


  
NameError (undefined local variable or method `teste' for #<Interactors::BuildPayload:0x00007f0d382c8a98>
Did you mean?  test):
  
lib/interactors/build_payload.rb:53:in `block in items_hash'
lib/interactors/build_payload.rb:51:in `each'
lib/interactors/build_payload.rb:51:in `items_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:15:19 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (1.7ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (1.1ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.7ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (1.3ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (4.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.9ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.9ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 59516ms (ActiveRecord: 104.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:16:25 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (1.9ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 90ms (ActiveRecord: 24.1ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5012.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (124.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (112.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (308.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (316.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 17:16:44.423606"], ["updated_at", "2021-05-09 17:16:44.423606"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (11.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (11.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 17:16:44.607370"], ["updated_at", "2021-05-09 17:16:44.607370"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 17:16:44.612047"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (3.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (4.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 17:16:48.992675"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 17:16:48.996289"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 14:16:59 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (1.0ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (2.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.7ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.6ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (1.3ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 40391ms (ActiveRecord: 92.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 14:31:32 -0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.9ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (1.0ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 147ms (ActiveRecord: 23.7ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (120.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (304.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (322.6ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 17:31:44.726493"], ["updated_at", "2021-05-09 17:31:44.726493"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (12.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 17:31:44.896199"], ["updated_at", "2021-05-09 17:31:44.896199"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 17:31:44.900843"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (4.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (19.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (5.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (14.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (4.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (18.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (19.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (12.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (4.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (23.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (14.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 17:31:51.491777"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 17:31:51.496323"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 14:31:58 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.8ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (1.0ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.8ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.6ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.7ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.8ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (1.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 47436ms (ActiveRecord: 60.1ms)


  
NameError (undefined local variable or method `items_hash' for #<Interactors::BuildPayload:0x00005638050198c8>):
  
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:14:57 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.6ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.8ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.9ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (1.1ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.5ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.7ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 1015537ms (ActiveRecord: 13.5ms)


  
NameError (undefined local variable or method `items_hash' for #<Interactors::BuildPayload:0x00007ff614823658>):
  
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:31:57 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.6ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.4ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.4ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 69316ms (ActiveRecord: 53.0ms)


  
NameError (undefined local variable or method `items_hash' for #<Interactors::BuildPayload:0x00007ff614557370>
Did you mean?  items_list):
  
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:33:13 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.9ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.3ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 34738ms (ActiveRecord: 58.0ms)


  
NameError (undefined local variable or method `items_hash' for #<Interactors::BuildPayload:0x00007ff6107de700>
Did you mean?  items_list):
  
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:33:52 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.7ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.4ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.3ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 41378ms (ActiveRecord: 51.7ms)


  
NameError (undefined local variable or method `items_hash' for #<Interactors::BuildPayload:0x00007ff610571a30>
Did you mean?  items_list):
  
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:36:20 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.7ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.8ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.9ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.8ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 18527ms (ActiveRecord: 66.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:39:30 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (1.7ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 86ms (ActiveRecord: 19.3ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5015.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (119.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (317.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (336.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 18:39:54.950273"], ["updated_at", "2021-05-09 18:39:54.950273"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 18:39:55.121918"], ["updated_at", "2021-05-09 18:39:55.121918"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:39:55.125802"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 18:40:00.905412"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:40:00.909599"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 15:40:14 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :quantity
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:74
  [1m[36mCity Create (1.0ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.8ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.2ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:91
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:110
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:117
  [1m[36mPayment Load (0.6ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:118
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:122
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:122
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:122
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 69431ms (ActiveRecord: 60.9ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5015.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (4.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 18:41:37.063272"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:41:37.068432"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 15:46:17 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 10ms (ActiveRecord: 4.1ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:70: syntax error, unexpected tSTRING_BEG, expecting '}'
    				"value": payment.total_paid_am...
    				^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:70: syntax error, unexpected ':', expecting keyword_end
    				"value": payment.total_paid_amount
    				       ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
    			}
    			^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input):
  
lib/interactors/build_payload.rb:70: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:70: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:46:38 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 11ms (ActiveRecord: 4.1ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:69: syntax error, unexpected ':', expecting =>
    				"type" :  payment.type,
    				       ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:70: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
    				"value": payment.total_paid_amount
    				      ^~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
    			}
    			^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input):
  
lib/interactors/build_payload.rb:69: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:70: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:47:43 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 7ms (ActiveRecord: 4.3ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:69: syntax error, unexpected ':', expecting =>
    				"type" :  payment.type,
    				       ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:70: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
    				"value": payment.total_paid_amount
    				      ^~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
    			}
    			^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input):
  
lib/interactors/build_payload.rb:69: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:70: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
lib/interactors/build_payload.rb:71: syntax error, unexpected '}', expecting keyword_end
lib/interactors/build_payload.rb:79: syntax error, unexpected keyword_end, expecting end-of-input
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:49:22 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 7ms (ActiveRecord: 3.2ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "payments": payments_list
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
		    "payments": payments_list
		              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:70: syntax error, unexpected ':', expecting =>
    				"type" :  payment.type,
    				       ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:71: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
    				"value": payment.total_paid_amount
    				      ^~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:72: syntax error, unexpected '}', expecting keyword_end
    			}
    			^):
  
lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:70: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:71: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
lib/interactors/build_payload.rb:72: syntax error, unexpected '}', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:52:03 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 8ms (ActiveRecord: 3.6ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "payments": payments_list
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
		    "payments": payments_list
		              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:85: syntax error, unexpected ':', expecting =>
    				"type" :  payment.type,
    				       ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:86: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
    				"value": 	payment.total_paid_amount
    				      ^~
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:87: syntax error, unexpected '}', expecting keyword_end
    			}
    			^):
  
lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:85: syntax error, unexpected ':', expecting =>
lib/interactors/build_payload.rb:86: syntax error, unexpected tLABEL_END, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END
lib/interactors/build_payload.rb:87: syntax error, unexpected '}', expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:52:20 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 10ms (ActiveRecord: 4.5ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "payments": payments_list
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
		    "payments": payments_list
		              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end):
  
lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:52:58 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 10ms (ActiveRecord: 2.8ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "payments": items_list
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
		    "payments": items_list
		              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end):
  
lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:53:01 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.5ms)


  
SyntaxError (/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
		    "payments": items_list
		    ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
		    "payments": items_list
		              ^
/home/danilo/Documents/projects/snackonboard/order-parsing-api/order-parsing-api/lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end):
  
lib/interactors/build_payload.rb:42: syntax error, unexpected tSTRING_BEG, expecting '}'
lib/interactors/build_payload.rb:42: syntax error, unexpected ':', expecting keyword_end
lib/interactors/build_payload.rb:82: syntax error, unexpected end-of-input, expecting keyword_end
lib/organizers/create_order.rb:5:in `<class:CreateOrder>'
lib/organizers/create_order.rb:2:in `<module:Organizers>'
lib/organizers/create_order.rb:1:in `<top (required)>'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:53:11 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (2.2ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.7ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.9ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.7ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (1.0ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.7ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 218ms (ActiveRecord: 66.2ms)


  
NoMethodError (undefined method `type' for #<Payment:0x00007f8599088ab0>):
  
lib/interactors/build_payload.rb:70:in `block in payments_list'
lib/interactors/build_payload.rb:67:in `each'
lib/interactors/build_payload.rb:67:in `payments_list'
lib/interactors/build_payload.rb:42:in `parsed_hash'
lib/interactors/build_payload.rb:8:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 15:53:41 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.3ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.9ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.4ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.3ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.4ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 225ms (ActiveRecord: 60.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5014.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (10.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (19.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 18:54:05.616194"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:54:05.621429"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (121.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (109.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (301.8ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (322.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 18:54:09.831217"], ["updated_at", "2021-05-09 18:54:09.831217"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (13.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (13.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (21.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 18:54:10.033099"], ["updated_at", "2021-05-09 18:54:10.033099"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:54:10.038707"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (4.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 18:54:12.717391"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 18:54:12.720872"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 15:54:44 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.6ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (1.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.7ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.8ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 516262ms (ActiveRecord: 66.4ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 16:04:06 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (5.1ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (0.8ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 131ms (ActiveRecord: 38.1ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5015.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (119.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (303.1ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (320.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:05:32.302397"], ["updated_at", "2021-05-09 19:05:32.302397"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (12.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:05:32.494777"], ["updated_at", "2021-05-09 19:05:32.494777"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:05:32.499548"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (11.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 19:05:38.515373"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:05:38.519912"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:05:50 -0300
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (1.8ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.2ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.7ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.9ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.6ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.5ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 471237ms (ActiveRecord: 74.9ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 16:18:49 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (1.3ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 117ms (ActiveRecord: 28.8ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (119.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (304.9ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (310.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:19:13.104073"], ["updated_at", "2021-05-09 19:19:13.104073"]]
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (12.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:19:13.270512"], ["updated_at", "2021-05-09 19:19:13.270512"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:19:13.275219"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (3.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 19:19:18.693615"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:19:18.697822"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:19:34 -0300
  [1m[35m (3.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (1.0ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.6ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.8ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (2.8ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.4ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.5ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.5ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 142442ms (ActiveRecord: 85.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 16:25:38 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mPayment Create (2.1ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 103ms (ActiveRecord: 31.1ms)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "payments_pkey"
DETAIL:  Key (id)=(12312313) already exists.
: INSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"):
  
lib/interactors/parse_order.rb:57:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5016.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (117.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (109.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (315.8ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (326.1ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (11.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:26:01.810443"], ["updated_at", "2021-05-09 19:26:01.810443"]]
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.4ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (9.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (20.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:26:01.993684"], ["updated_at", "2021-05-09 19:26:01.993684"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:26:01.997817"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (4.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (5.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (10.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 19:26:05.137826"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:26:05.143395"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:26:13 -0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (2.9ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.7ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.8ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (2.4ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[36mOrderItem Load (0.5ms)[0m  [1m[34mSELECT "order_items".* FROM "order_items" WHERE "order_items"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:115
  [1m[36mPayment Load (0.4ms)[0m  [1m[34mSELECT "payments".* FROM "payments" WHERE "payments"."order_id" = $1[0m  [["order_id", 9987071]]
  â†³ lib/interactors/parse_order.rb:116
  [1m[36mOrder Create (0.6ms)[0m  [1m[32mINSERT INTO "orders" ("id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status", "buyer_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["id", 9987071], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 666], ["status", "paid"], ["buyer_id", 136226073]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrderItem Create (1.0ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 9987071], ["item_id", 0], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["id", 12312313], ["order_id", 9987071], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 209666ms (ActiveRecord: 70.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (117.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (321.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (324.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:37:49.539958"], ["updated_at", "2021-05-09 19:37:49.539958"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (21.5ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:37:49.729731"], ["updated_at", "2021-05-09 19:37:49.729731"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:37:49.734646"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (4.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (3.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (11.1ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 19:37:55.874652"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:37:55.878376"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (123.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (112.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (300.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (316.7ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (13.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:48:57.454456"], ["updated_at", "2021-05-09 19:48:57.454456"]]
  â†³ db/schema.rb:13
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (11.6ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210509015724)[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210509014654),
(20210509015605),
(20210509014227),
(20210509014150),
(20210509015524),
(20210509015051),
(20210509015659),
(20210509015445),
(20210509015417),
(20210509015455),
(20210509015224),
(20210509014311);

[0m
  â†³ db/schema.rb:13
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:48:57.634800"], ["updated_at", "2021-05-09 19:48:57.634800"]]
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:48:57.639137"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (2.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (4.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (12.4ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (11.3ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (3.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (9.9ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.9ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (2.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (1.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (3.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "billing_infos" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "buyers" CASCADE[0m
  â†³ db/schema.rb:23
  [1m[35m (6.8ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/schema.rb:23
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "cities" CASCADE[0m
  â†³ db/schema.rb:32
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:32
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "countries" CASCADE[0m
  â†³ db/schema.rb:36
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "initials" character varying, "name" character varying)[0m
  â†³ db/schema.rb:36
  [1m[35m (3.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "items" CASCADE[0m
  â†³ db/schema.rb:41
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "title" character varying)[0m
  â†³ db/schema.rb:41
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "neighborhoods" CASCADE[0m
  â†³ db/schema.rb:45
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:45
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "order_items" CASCADE[0m
  â†³ db/schema.rb:49
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/schema.rb:49
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "orders" CASCADE[0m
  â†³ db/schema.rb:57
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/schema.rb:57
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "payments" CASCADE[0m
  â†³ db/schema.rb:72
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/schema.rb:72
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "phones" CASCADE[0m
  â†³ db/schema.rb:88
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/schema.rb:88
  [1m[35m (1.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "receiver_addresses" CASCADE[0m
  â†³ db/schema.rb:93
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/schema.rb:93
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "shippings" CASCADE[0m
  â†³ db/schema.rb:108
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/schema.rb:108
  [1m[35m (2.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "states" CASCADE[0m
  â†³ db/schema.rb:114
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/schema.rb:114
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Update (0.3ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "development"], ["updated_at", "2021-05-09 19:49:03.893705"], ["key", "environment"]]
  â†³ db/schema.rb:13
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-05-09 19:49:03.898167"], ["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:49:10 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:57
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:68
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:72
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.7ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["id", 0], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:43
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:49
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:89
  [1m[36mShipping Create (0.6ms)[0m  [1m[32mINSERT INTO "shippings" ("id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["id", 666], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:108
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 37401ms (ActiveRecord: 55.6ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'external_id' for Order.):
  
lib/interactors/parse_order.rb:117:in `initialize_order'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 16:52:33 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 66ms (ActiveRecord: 19.4ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'external_id' for Payment.):
  
lib/interactors/parse_order.rb:59:in `block in initialize_payments'
lib/interactors/parse_order.rb:56:in `each'
lib/interactors/parse_order.rb:56:in `initialize_payments'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (108.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (319.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (315.2ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 19:56:42.548479"], ["updated_at", "2021-05-09 19:56:42.548479"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2021-05-09 19:56:42.579394"], ["updated_at", "2021-05-09 19:56:42.579394"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:56:57 -0300
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate RAILS_ENV=development

):
  
activerecord (5.2.6) lib/active_record/migration.rb:579:in `check_pending!'
activerecord (5.2.6) lib/active_record/migration.rb:556:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.6) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.6) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.6) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.6) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.6) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.6) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.6) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.6) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrders (20210509014150)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "external_id" character varying, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" integer, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/migrate/20210509014150_create_orders.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014150"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (3.8ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.6ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "external_id" character varying, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "external_id" character varying, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (11.4ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "external_id" character varying, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.2ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "external_id" character varying, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.8ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "external_id" character varying, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.3ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "external_id" character varying, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "external_id" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (5.9ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 16:58:07 -0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.9ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.8ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.9ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.8ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 199ms (ActiveRecord: 54.3ms)


  
NoMethodError (undefined method `delete' for nil:NilClass):
  
lib/interactors/parse_order.rb:144:in `map_to_external_id'
lib/interactors/parse_order.rb:115:in `initialize_shipping'
lib/interactors/parse_order.rb:13:in `block in initialize_entities'
lib/interactors/parse_order.rb:12:in `each'
lib/interactors/parse_order.rb:12:in `initialize_entities'
lib/interactors/parse_order.rb:6:in `call'
lib/operations/orders/create_order_operation.rb:21:in `start_operation'
lib/operations/orders/create_order_operation.rb:8:in `block in call'
lib/operations/orders/create_order_operation.rb:7:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 16:58:57 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.7ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.8ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 1], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 1], ["item_id", 2], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (1.2ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 1], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 59028ms (ActiveRecord: 62.2ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:00:02 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.6ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.5ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.4ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.7ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (1.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (1.0ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 2], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.4ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 2], ["item_id", 3], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (1.0ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 2], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 4549ms (ActiveRecord: 11.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:00:12 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameter: :street_name
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.9ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (5.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (1.4ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.5ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (1.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.7ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (1.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.5ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.7ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (1.2ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 3], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 3], ["item_id", 4], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (1.0ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 3], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 116313ms (ActiveRecord: 20.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:02:11 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (1.0ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.4ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.3ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 4], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.4ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 4], ["item_id", 5], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 4], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 89209ms (ActiveRecord: 61.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:03:50 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.6ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.6ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.4ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.4ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 5], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 5], ["item_id", 6], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (1.0ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 5], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 252657ms (ActiveRecord: 66.7ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:08:10 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (2.5ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (10.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.3ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.4ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.7ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.4ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (2.6ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 6], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 6], ["item_id", 7], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[36mPayment Create (0.9ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 6], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:134
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 191770ms (ActiveRecord: 24.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:11:27 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "orders"[0m
  â†³ (pry):15
  [1m[36mOrder Load (0.8ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" ORDER BY "orders"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):16
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 7], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mOrderItem Create (0.4ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 7], ["item_id", 8], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mPayment Create (0.4ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 7], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 282414ms (ActiveRecord: 60.6ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:16:19 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.4ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.3ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.2ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.3ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.4ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.5ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 8], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mOrderItem Create (0.6ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 8], ["item_id", 9], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mPayment Create (1.5ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 8], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 26306ms (ActiveRecord: 10.1ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (118.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_development"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (107.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "order-parsing-api_test"[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (319.3ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (315.0ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-05-09 20:17:28.407708"], ["updated_at", "2021-05-09 20:17:28.407708"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2021-05-09 20:17:28.443650"], ["updated_at", "2021-05-09 20:17:28.443650"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_development" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "order-parsing-api_test" ENCODING = 'unicode'[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrders (20210509014150)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "orders" ("id" bigserial primary key, "external_id" character varying, "store_id" integer, "date_created" timestamp, "date_closed" timestamp, "last_updated" timestamp, "total_amount" float, "total_shipping" float, "total_amount_with_shipping" float, "paid_amount" float, "expiration_date" timestamp, "shipping_id" integer, "status" character varying, "buyer_id" integer)[0m
  â†³ db/migrate/20210509014150_create_orders.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014150"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateOrderItems (20210509014227)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (4.0ms)[0m  [1m[35mCREATE TABLE "order_items" ("id" bigserial primary key, "order_id" integer, "item_id" integer, "quantity" integer, "unit_price" float, "full_unit_price" float)[0m
  â†³ db/migrate/20210509014227_create_order_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014227"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePayments (20210509014311)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "payments" ("id" bigserial primary key, "external_id" character varying, "order_id" integer, "payer_id" integer, "installments" integer, "payment_type" character varying, "paid" character varying, "status" character varying, "transaction_amount" float, "taxes_amount" integer, "shipping_cost" float, "total_paid_amount" float, "installment_amount" float, "date_approved" timestamp, "date_created" timestamp)[0m
  â†³ db/migrate/20210509014311_create_payments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014311"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateShippings (20210509014654)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "shippings" ("id" bigserial primary key, "external_id" character varying, "shipment_type" character varying, "date_created" timestamp, "receiver_address_id" integer)[0m
  â†³ db/migrate/20210509014654_create_shippings.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509014654"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBuyers (20210509015051)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "buyers" ("id" bigserial primary key, "external_id" character varying, "nickname" character varying, "email" character varying, "phone_id" integer, "first_name" character varying, "last_name" character varying, "billing_info_id" integer)[0m
  â†³ db/migrate/20210509015051_create_buyers.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015051"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateItems (20210509015224)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE "items" ("id" bigserial primary key, "external_id" character varying, "title" character varying)[0m
  â†³ db/migrate/20210509015224_create_items.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015224"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateReceiverAddresses (20210509015417)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "receiver_addresses" ("id" bigserial primary key, "external_id" character varying, "address_line" character varying, "street_name" character varying, "street_number" character varying, "comment" character varying, "zip_code" character varying, "city_id" integer, "state_id" integer, "country_id" integer, "neighborhood_id" integer, "latitude" integer, "longitude" integer, "receiver_phone" character varying)[0m
  â†³ db/migrate/20210509015417_create_receiver_addresses.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015417"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCities (20210509015445)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.2ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015445_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015445"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateStates (20210509015455)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (11.4ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying)[0m
  â†³ db/migrate/20210509015455_create_states.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015455"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateCountries (20210509015524)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "external_id" character varying, "initials" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015524_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015524"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateNeighborhoods (20210509015605)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE "neighborhoods" ("id" bigserial primary key, "external_id" character varying, "name" character varying)[0m
  â†³ db/migrate/20210509015605_create_neighborhoods.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015605"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreatePhones (20210509015659)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "phones" ("id" bigserial primary key, "area_code" integer, "number" character varying)[0m
  â†³ db/migrate/20210509015659_create_phones.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015659"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Migrating to CreateBillingInfos (20210509015724)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "billing_infos" ("id" bigserial primary key, "doc_type" character varying, "doc_number" character varying)[0m
  â†³ db/migrate/20210509015724_create_billing_infos.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210509015724"]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7125409267440505860)[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/bin/rake:23
Started POST "/api/orders" for ::1 at 2021-05-09 17:17:58 -0300
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/danilo/.rvm/gems/ruby-2.5.5/gems/activerecord-5.2.6/lib/active_record/log_subscriber.rb:98
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.8ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.8ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.7ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.7ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (1.2ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.7ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (1.0ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.7ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5.14], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 1], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mOrderItem Create (0.8ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 1], ["item_id", 1], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mPayment Create (0.6ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 1], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 35573ms (ActiveRecord: 60.8ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
Started POST "/api/orders" for ::1 at 2021-05-09 17:18:39 -0300
Processing by Api::OrdersController#create as */*
  Parameters: {"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "order_items"=>[{"item"=>{"id"=>"IT4801901403", "title"=>"Produto de Testes"}, "quantity"=>1, "unit_price"=>49.9, "full_unit_price"=>49.9}], "payments"=>[{"id"=>12312313, "order_id"=>9987071, "payer_id"=>414138, "installments"=>1, "payment_type"=>"credit_card", "status"=>"paid", "transaction_amount"=>49.9, "taxes_amount"=>0, "shipping_cost"=>5.14, "total_paid_amount"=>55.04, "installment_amount"=>55.04, "date_approved"=>"2019-06-24T16:45:35.000-04:00", "date_created"=>"2019-06-24T16:45:33.000-04:00"}], "shipping"=>{"id"=>666, "shipment_type"=>"shipping", "date_created"=>"2019-06-24T16:45:33.000-04:00", "receiver_address"=>{"id"=>1051695306, "address_line"=>"Rua Fake de Testes 3454", "street_name"=>"Rua Fake de Testes", "street_number"=>"3454", "comment"=>"teste", "zip_code"=>"85045020", "city"=>{"name"=>"Cidade de Testes"}, "state"=>{"name"=>"SÃ£o Paulo"}, "country"=>{"id"=>"BR", "name"=>"Brasil"}, "neighborhood"=>{"id"=>nil, "name"=>"Vila de Testes"}, "latitude"=>-23.629037, "longitude"=>-46.712689, "receiver_phone"=>"41999999999"}}, "status"=>"paid", "buyer"=>{"id"=>136226073, "nickname"=>"JOHN DOE", "email"=>"john@doe.com", "phone"=>{"area_code"=>41, "number"=>"999999999"}, "first_name"=>"John", "last_name"=>"Doe", "billing_info"=>{"doc_type"=>"CPF", "doc_number"=>"09487965477"}}, "order"=>{"id"=>9987071, "store_id"=>282, "date_created"=>"2019-06-24T16:45:32.000-04:00", "date_closed"=>"2019-06-24T16:45:35.000-04:00", "last_updated"=>"2019-06-25T13:26:49.000-04:00", "total_amount"=>49.9, "total_shipping"=>5.14, "total_amount_with_shipping"=>55.04, "paid_amount"=>55.04, "expiration_date"=>"2019-07-22T16:45:35.000-04:00", "status"=>"paid"}}
Unpermitted parameters: :last_updated, :order
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
  [1m[36mBillingInfo Create (0.5ms)[0m  [1m[32mINSERT INTO "billing_infos" ("doc_type", "doc_number") VALUES ($1, $2) RETURNING "id"[0m  [["doc_type", "CPF"], ["doc_number", "09487965477"]]
  â†³ lib/interactors/parse_order.rb:19
  [1m[36mPhone Create (0.4ms)[0m  [1m[32mINSERT INTO "phones" ("area_code", "number") VALUES ($1, $2) RETURNING "id"[0m  [["area_code", 41], ["number", "999999999"]]
  â†³ lib/interactors/parse_order.rb:25
  [1m[36mOrder Load (0.5ms)[0m  [1m[34mSELECT  "orders".* FROM "orders" WHERE "orders"."id" = $1 LIMIT $2[0m  [["id", 9987071], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:63
  [1m[36mItem Create (0.5ms)[0m  [1m[32mINSERT INTO "items" ("external_id", "title") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "IT4801901403"], ["title", "Produto de Testes"]]
  â†³ lib/interactors/parse_order.rb:76
  [1m[36mItem Load (0.4ms)[0m  [1m[34mSELECT  "items".* FROM "items" WHERE "items"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:80
  [1m[36mCity Create (0.9ms)[0m  [1m[32mINSERT INTO "cities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Cidade de Testes"]]
  â†³ lib/interactors/parse_order.rb:31
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "SÃ£o Paulo"]]
  â†³ lib/interactors/parse_order.rb:37
  [1m[36mCountry Create (0.6ms)[0m  [1m[32mINSERT INTO "countries" ("external_id", "name") VALUES ($1, $2) RETURNING "id"[0m  [["external_id", "BR"], ["name", "Brasil"]]
  â†³ lib/interactors/parse_order.rb:45
  [1m[36mCountry Create (0.9ms)[0m  [1m[32mINSERT INTO "countries" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Vila de Testes"]]
  â†³ lib/interactors/parse_order.rb:53
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT  "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mNeighborhood Load (0.3ms)[0m  [1m[34mSELECT  "neighborhoods".* FROM "neighborhoods" WHERE "neighborhoods"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ lib/interactors/parse_order.rb:97
  [1m[36mShipping Create (0.9ms)[0m  [1m[32mINSERT INTO "shippings" ("external_id", "shipment_type", "date_created", "receiver_address_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["external_id", "666"], ["shipment_type", "shipping"], ["date_created", "2019-06-24 20:45:33"], ["receiver_address_id", 1051695306]]
  â†³ lib/interactors/parse_order.rb:120
  [1m[36mOrder Create (0.5ms)[0m  [1m[32mINSERT INTO "orders" ("external_id", "store_id", "date_created", "date_closed", "total_amount", "total_shipping", "total_amount_with_shipping", "paid_amount", "expiration_date", "shipping_id", "status") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["external_id", "9987071"], ["store_id", 282], ["date_created", "2019-06-24 20:45:32"], ["date_closed", "2019-06-24 20:45:35"], ["total_amount", 49.9], ["total_shipping", 5.14], ["total_amount_with_shipping", 55.04], ["paid_amount", 55.04], ["expiration_date", "2019-07-22 20:45:35"], ["shipping_id", 2], ["status", "paid"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mOrderItem Create (0.5ms)[0m  [1m[32mINSERT INTO "order_items" ("order_id", "item_id", "quantity", "unit_price", "full_unit_price") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["order_id", 2], ["item_id", 2], ["quantity", 1], ["unit_price", 49.9], ["full_unit_price", 49.9]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[36mPayment Create (0.8ms)[0m  [1m[32mINSERT INTO "payments" ("external_id", "order_id", "payer_id", "installments", "payment_type", "status", "transaction_amount", "taxes_amount", "shipping_cost", "total_paid_amount", "installment_amount", "date_approved", "date_created") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) RETURNING "id"[0m  [["external_id", "12312313"], ["order_id", 2], ["payer_id", 414138], ["installments", 1], ["payment_type", "credit_card"], ["status", "paid"], ["transaction_amount", 49.9], ["taxes_amount", 0], ["shipping_cost", 5.14], ["total_paid_amount", 55.04], ["installment_amount", 55.04], ["date_approved", "2019-06-24 20:45:35"], ["date_created", "2019-06-24 20:45:33"]]
  â†³ lib/interactors/parse_order.rb:135
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ lib/operations/orders/create_order_operation.rb:7
Completed 500 Internal Server Error in 29131ms (ActiveRecord: 76.0ms)


  
NoMethodError (undefined method `assigns' for nil:NilClass):
  
lib/operations/orders/create_order_operation.rb:13:in `call'
app/controllers/api/orders_controller.rb:4:in `create'
